<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Analysis with G-G Fluctuation</title>
    <link rel="stylesheet" href="assets/style.css">
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Tab styling */
        .tabs {
            display: flex;
            border-bottom: 1px solid #ccc;
            margin-bottom: 0;
            padding-left: 0;
            list-style: none;
        }

        .tab-item {
            margin-bottom: -1px;
        }

        .tab-link {
            display: block;
            padding: 0.5rem 1rem;
            border: 1px solid transparent;
            border-top-left-radius: 0.25rem;
            border-top-right-radius: 0.25rem;
            text-decoration: none;
            color: #495057;
            cursor: pointer;
        }

        .tab-link:hover {
            border-color: #e9ecef #e9ecef #dee2e6;
            background-color: #f8f9fa;
        }

        .tab-link.active {
            color: #007bff;
            background-color: #fff;
            border-color: #dee2e6 #dee2e6 #fff;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 0.25rem 0.25rem;
        }

        .tab-content.active {
            display: block;
        }

        /* Statistical table styling (used by React component's table) */
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.95em;
        }

        .stats-table th {
            background-color: #e9ecef;
            font-weight: bold;
            padding: 8px 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .stats-table td {
            padding: 8px 12px;
            border: 1px solid #ddd;
            position: relative;
        }
        .even-row {
            background-color: #f8f9fa;
        }
        .sig-star, .sig-star-2, .sig-star-3, .sig-ns { /* If needed by static part */
            color: #dc3545;
            font-weight: bold;
            margin-left: 5px;
            font-size: 0.9em;
        }
        .legend { /* If needed by static part */
            margin-top: 10px;
            font-size: 0.85em;
            color: #666;
            padding: 8px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Test Analysis with G-G Fluctuation</h1>
        <p class="timestamp">Report Generated: 2025-05-11 09:10:13</p>
        
            <div class="metadata-summary">
                <p>
                    Comparing System Groups:
                    
                        <span class="toxin-group">3 Toxin-Bound System(s)</span>
                    
                    
                        vs. <span class="control-group">3 Toxin-Free (Control) System(s)</span>
                    
                </p>
                <p>Toxin Name (if applicable): <span class="toxin-name">toxin</span></p>
                <p>Channel Name: <span class="channel-name">UnknownChannel</span></p>
            </div>
        
    </header>

    <ul class="tabs" id="reportTabs">
        <li class="tab-item">
            <a class="tab-link active" data-tab="overview">System Overview</a>
        </li>
        <li class="tab-item">
            <a class="tab-link" data-tab="pore-geometry">Pore Geometry</a>
        </li>
        <li class="tab-item">
            <a class="tab-link" data-tab="pore-fluctuation">Pore Fluctuation</a>
        </li>
    </ul>

    <div class="tab-content active" id="overview">
        <section class="section">
            <h2>System Overview</h2>
            
                <p class="section-description">This section provides a high-level summary of the simulation systems included in this comparative analysis.</p>
            

            
                <h3>High-Level Summary</h3>
                <table class="metrics-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                        <tr>
                            <td>Number of Toxin-Bound Systems</td>
                            <td>
                                
                                    <span class="toxin-value">3.0</span>
                                
                                systems
                            </td>
                        </tr>
                        
                        <tr>
                            <td>Number of Toxin-Free (Control) Systems</td>
                            <td>
                                
                                    <span class="control-value">3.0</span>
                                
                                systems
                            </td>
                        </tr>
                        
                        <tr>
                            <td>Avg. Trajectory Frames (Toxin)</td>
                            <td>
                                
                                    <span class="toxin-value">1200.0</span>
                                
                                frames
                            </td>
                        </tr>
                        
                        <tr>
                            <td>Avg. Trajectory Frames (Control)</td>
                            <td>
                                
                                    <span class="control-value">1200.0</span>
                                
                                frames
                            </td>
                        </tr>
                        
                        <tr>
                            <td>Total Unique Metrics Collected</td>
                            <td>
                                
                                    22.0
                                
                                metrics
                            </td>
                        </tr>
                        
                    </tbody>
                </table>
            

            
                <h3>Toxin-Bound Systems</h3>
                <ul class="system-list">
                    
                        <li class="toxin-system">toxin_run2_toxin</li>
                    
                        <li class="toxin-system">toxin_run1_toxin</li>
                    
                        <li class="toxin-system">toxin_run3_toxin</li>
                    
                </ul>
            

            
                <h3>Control Systems</h3>
                <ul class="system-list">
                    
                        <li class="control-system">control_run2_control</li>
                    
                        <li class="control-system">control_run3_control</li>
                    
                        <li class="control-system">control_run1_control</li>
                    
                </ul>
            

            
                <h3>AI-Generated Interpretation</h3>
                <div class="ai-interpretation">
                    This report compares 3 toxin-bound system(s) with 3 control system(s). The toxin used in this study appears to be toxin.

The simulation data has been analyzed across multiple metrics to identify significant differences between the toxin-bound and control states. Additional sections in this report will explore specific aspects of the system&#39;s behavior in more detail, focusing on metrics that show statistically significant differences between the two groups.
                </div>
            
        </section>
    </div>

    <div class="tab-content" id="pore-geometry">
        <section class="section">
            <p class="section-description">
                Interactive visualization of G-G distances across the selectivity filter,
                comparing toxin-bound and control systems. Data based on N=3 simulations.
            </p>

            <div id="gg-distance-react-root"></div>

            
            <div id="gg-static-tables" class="mt-8 w-full" style="display: none;"> <h3>G-G Distance Measurements (Summary Table)</h3>
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Toxin A:C</th>
                            <th>Toxin B:D</th>
                            <th>Control A:C</th>
                            <th>Control B:D</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mean (Å)</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                        </tr>
                        <tr class="even-row">
                            <td>Min (Å)</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                        </tr>
                        <tr>
                            <td>Max (Å)</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                        </tr>
                        <tr class="even-row">
                            <td>Range (Å)</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-4 w-full">
                    <h3>Statistical Analysis (Summary Table)</h3>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Comparison</th>
                                <th>A:C p-value</th>
                                <th>B:D p-value</th>
                                <th>A:C Effect Size</th>
                                <th>B:D Effect Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Mean G-G Distance</td>
                                <td>1.0000</td>
                                <td>1.0000</td>
                                <td>0.00</td>
                                <td>0.00</td>
                            </tr>
                            <tr class="even-row">
                                <td>Min G-G Distance</td>
                                <td>1.0000</td>
                                <td>1.0000</td>
                                <td>0.00</td>
                                <td>0.00</td>
                            </tr>
                            <tr>
                                <td>Max G-G Distance</td>
                                <td>1.0000</td>
                                <td>1.0000</td>
                                <td>0.00</td>
                                <td>0.00</td>
                            </tr>
                            <tr class="even-row">
                                <td>Range (Max-Min)</td>
                                <td>1.0000</td>
                                <td>1.0000</td>
                                <td>0.00</td>
                                <td>0.00</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="legend">
                        <p>P-values are calculated using Welch's t-test (for unequal variances). Effect size is calculated using Cohen's d.</p>
                        <p>Interpretation: p &lt; 0.05 = significant, p &lt; 0.01 = highly significant. Cohen's d: 0.2 = small, 0.5 = moderate, 0.8 = large, 1.2+ = very large effect.</p>
                    </div>
                </div>
            </div>
            
        </section>
    </div>

    <div class="tab-content" id="pore-fluctuation">
        <section class="section">
            <p class="section-description">
                Analysis of G-G distance fluctuations (standard deviation of G-G distance time series)
                comparing toxin-bound and control systems. Data based on N=3 simulations.
            </p>

            <div id="gg-fluctuation-react-root"></div>

            
            <div id="gg-fluctuation-static-table" class="mt-8 w-full" style="display: none;">
                <h3>G-G Distance Fluctuation (Standard Deviation)</h3>
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Toxin A:C (Å)</th>
                            <th>Toxin B:D (Å)</th>
                            <th>Control A:C (Å)</th>
                            <th>Control B:D (Å)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mean Fluctuation (StdDev)</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                            <td>nan ± nan</td>
                        </tr>
                    </tbody>
                </table>

                
                <div class="mt-4 w-full">
                    <h3>Statistical Analysis</h3>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Comparison</th>
                                <th>A:C p-value</th>
                                <th>B:D p-value</th>
                                <th>A:C Effect Size</th>
                                <th>B:D Effect Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>G-G Fluctuation</td>
                                <td>N/A</td>
                                <td>N/A</td>
                                <td>N/A</td>
                                <td>N/A</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
            
        </section>
    </div>

    <footer class="footer">
        <p>Enhanced Report Generation System</p>
        <p>Timestamp: 2025-05-11 09:10:13</p>
    </footer>

    <script>
        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabLinks = document.querySelectorAll('.tab-link');
            const tabContents = document.querySelectorAll('.tab-content');

            tabLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('data-tab');
                    tabLinks.forEach(tl => tl.classList.remove('active'));
                    tabContents.forEach(tc => tc.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        });
    </script>

    <script type="text/babel">
        // Data injected from Python/Jinja2
        const actualMockData = JSON.parse('{"toxin": {"AC": {"mean": {"value": NaN, "stdDev": NaN}, "min": {"value": NaN, "stdDev": NaN}, "max": {"value": NaN, "stdDev": NaN}, "range": {"value": NaN, "stdDev": NaN}}, "BD": {"mean": {"value": NaN, "stdDev": NaN}, "min": {"value": NaN, "stdDev": NaN}, "max": {"value": NaN, "stdDev": NaN}, "range": {"value": NaN, "stdDev": NaN}}}, "control": {"AC": {"mean": {"value": NaN, "stdDev": NaN}, "min": {"value": NaN, "stdDev": NaN}, "max": {"value": NaN, "stdDev": NaN}, "range": {"value": NaN, "stdDev": NaN}}, "BD": {"mean": {"value": NaN, "stdDev": NaN}, "min": {"value": NaN, "stdDev": NaN}, "max": {"value": NaN, "stdDev": NaN}, "range": {"value": NaN, "stdDev": NaN}}}}');
        const actualStatisticalData = JSON.parse('{"mean": {"toxin-AC": {"pValue": 1.0, "effectSize": 0.0}, "toxin-BD": {"pValue": 1.0, "effectSize": 0.0}}, "min": {"toxin-AC": {"pValue": 1.0, "effectSize": 0.0}, "toxin-BD": {"pValue": 1.0, "effectSize": 0.0}}, "max": {"toxin-AC": {"pValue": 1.0, "effectSize": 0.0}, "toxin-BD": {"pValue": 1.0, "effectSize": 0.0}}, "range": {"toxin-AC": {"pValue": 1.0, "effectSize": 0.0}, "toxin-BD": {"pValue": 1.0, "effectSize": 0.0}}}');
        const actualSimulationPoints = JSON.parse('{"toxin": {"AC": {"mean": [], "min": [], "max": [], "range": []}, "BD": {"mean": [], "min": [], "max": [], "range": []}}, "control": {"AC": {"mean": [], "min": [], "max": [], "range": []}, "BD": {"mean": [], "min": [], "max": [], "range": []}}}');
        const numberOfSimulations = parseInt('3') || 5;

        // Data for fluctuation tab
        
        const actualFluctuationSummary = JSON.parse('{"toxin": {"AC": {"value": NaN, "stdDev": NaN}, "BD": {"value": NaN, "stdDev": NaN}}, "control": {"AC": {"value": NaN, "stdDev": NaN}, "BD": {"value": NaN, "stdDev": NaN}}}');
        const actualFluctuationIndividual = JSON.parse('{"toxin": {"AC": [], "BD": []}, "control": {"AC": [], "BD": []}}');
        const actualFluctuationStats = JSON.parse('{"p_values": {"AC": null, "BD": null}, "effect_sizes": {"AC": null, "BD": null}}');
        

        // Original GGDistanceTabbedComparison React Component (restored to your design)
        const GGDistanceTabbedComparison = () => {
            const [activeTab, setActiveTab] = React.useState('mean');

            // Use data passed from Python, ensuring original structure for styling
            const componentMockData = actualMockData; // Used for values and stdDevs
            const componentStatisticalData = JSON.parse(JSON.stringify(actualStatisticalData)); // Deep copy to modify for significance symbols
            const componentSimulationPoints = actualSimulationPoints; // Used for scatter points

            // Add significance symbols to statisticalData for the chart
            Object.keys(componentStatisticalData).forEach(metricKey => { // 'mean', 'min', etc.
                if (componentStatisticalData[metricKey]) {
                    Object.keys(componentStatisticalData[metricKey]).forEach(conditionKey => { // 'toxin-AC', 'toxin-BD'
                        const entry = componentStatisticalData[metricKey][conditionKey];
                        if (entry && typeof entry.pValue !== 'undefined') {
                            const pVal = entry.pValue;
                            let sigSymbol = "ns";
                            if (pVal < 0.0001) sigSymbol = "****";
                            else if (pVal < 0.001) sigSymbol = "***";
                            else if (pVal < 0.01) sigSymbol = "**";
                            else if (pVal < 0.05) sigSymbol = "*";
                            entry.significance = sigSymbol;
                        }
                    });
                }
            });

            // Original Styling constants from your design
            const chartWidth = 800;
            const chartHeight = 400;
            const margin = { top: 60, right: 150, bottom: 80, left: 80 }; // Restored
            const barWidth = 60; // Restored

            // Original Colors from your design
            const colors = { // Restored
                toxin: {
                    AC: { fill: 'rgba(200, 230, 255, 0.6)', border: 'rgba(70, 130, 180, 1)', point: 'rgba(0, 102, 204, 0.8)' },
                    BD: { fill: 'rgba(255, 200, 200, 0.6)', border: 'rgba(220, 20, 60, 1)', point: 'rgba(220, 20, 60, 0.8)' }
                },
                control: {
                    AC: { fill: 'rgba(200, 255, 200, 0.6)', border: 'rgba(34, 139, 34, 1)', point: 'rgba(34, 139, 34, 0.8)' },
                    BD: { fill: 'rgba(255, 230, 180, 0.6)', border: 'rgba(255, 140, 0, 1)', point: 'rgba(255, 140, 0, 0.8)' }
                }
            };

            // Original Y-scale function from your design
            const getYScale = (tab) => { // Restored
                let yMinUser = 7.4; // Default, will be overridden by switch
                let yMaxUser = 9.5; // Default, will be overridden by switch
                switch(tab) {
                    case 'mean': yMinUser = 7.7; yMaxUser = 8.5; break;
                    case 'min':  yMinUser = 7.2; yMaxUser = 7.7; break;
                    case 'max':  yMinUser = 8.0; yMaxUser = 9.5; break;
                    case 'range':yMinUser = 0.0; yMaxUser = 2.0; break;
                }
                return (val) => {
                    const availableHeight = chartHeight - margin.top - margin.bottom;
                    return chartHeight - margin.bottom - ((val - yMinUser) * (availableHeight / (yMaxUser - yMinUser)));
                };
            };

            // Original X positions from your design
            const xPositions = { // Restored
                'toxin-AC': margin.left + barWidth,
                'control-AC': margin.left + barWidth * 2 + 30,
                'toxin-BD': margin.left + barWidth * 3 + 80,
                'control-BD': margin.left + barWidth * 4 + 110
            };

            // Original Function to get tick values from your design
            const getTickValues = (tab) => { // Restored
                switch(tab) {
                    case 'mean': return [7.7, 7.9, 8.1, 8.3, 8.5];
                    case 'min':  return [7.2, 7.3, 7.4, 7.5, 7.6, 7.7];
                    case 'max':  return [8.0, 8.5, 9.0, 9.5];
                    case 'range':return [0, 0.5, 1.0, 1.5, 2.0];
                    default: return [7.5, 8.0, 8.5, 9.0, 9.5];
                }
            };

            // Helper functions to get data, using componentMockData and componentSimulationPoints
            const getValue = (data, tab) => data[tab].value;
            const getStdDev = (data, tab) => data[tab].stdDev;
            const getSimPoints = (condition, subunit, tab) => {
                return componentSimulationPoints?.[condition]?.[subunit]?.[tab] || [];
            }

            const renderBarChart = () => {
                const yScale = getYScale(activeTab);
                const tickValues = getTickValues(activeTab);

                return (
                    <svg width={chartWidth} height={chartHeight}>
                        {/* Title - Restored from original */}
                        <text x={chartWidth/2} y={30} textAnchor="middle" fontSize="16" fontWeight="bold">
                            G-G Distance {activeTab === 'range' ? 'Range' : activeTab.charAt(0).toUpperCase() + activeTab.slice(1)} Values
                        </text>

                        {/* Y-axis - Restored from original */}
                        <line x1={margin.left} y1={margin.top} x2={margin.left} y2={chartHeight - margin.bottom} stroke="black" strokeWidth="1.5" />
                        {tickValues.map((tick, i) => (
                            <g key={`y-tick-${i}`}>
                                <line x1={margin.left - 5} y1={yScale(tick)} x2={margin.left} y2={yScale(tick)} stroke="black" strokeWidth="1"/>
                                <text x={margin.left - 10} y={yScale(tick)} textAnchor="end" dominantBaseline="middle" fontSize="12">
                                    {tick.toFixed(1)} {activeTab === 'range' ? '' : 'Å'}
                                </text>
                            </g>
                        ))}
                        <text transform={`rotate(-90, ${margin.left/3}, ${chartHeight/2})`} x={margin.left/3} y={chartHeight/2} textAnchor="middle" fontSize="14" fontWeight="bold">
                            {activeTab === 'range' ? 'Range (Å)' : 'G-G Distance (Å)'}
                        </text>

                        {/* X-axis - Restored from original */}
                        <line x1={margin.left} y1={chartHeight - margin.bottom} x2={chartWidth - margin.right + 100} y2={chartHeight - margin.bottom} stroke="black" strokeWidth="1.5" />
                        
                        {/* Bars and Error Bars - Logic restored from original */}
                        {Object.entries(xPositions).map(([key, xPos]) => {
                            const [condition, subunit] = key.split('-'); // 'toxin', 'AC'
                            const dataSeries = componentMockData[condition]?.[subunit];
                            if (!dataSeries) return null; // Skip if data is missing

                            const value = getValue(dataSeries, activeTab);
                            const stdDev = getStdDev(dataSeries, activeTab);
                            const simPoints = getSimPoints(condition, subunit, activeTab);
                            const colorSet = colors[condition]?.[subunit];
                            if (!colorSet) return null; // Skip if colors are missing

                            return (
                                <g key={key}>
                                    <rect
                                        x={xPos - barWidth/2}
                                        y={yScale(value)}
                                        width={barWidth}
                                        height={Math.max(0, (chartHeight - margin.bottom) - yScale(value))} // Ensure non-negative height
                                        fill={colorSet.fill}
                                        stroke={colorSet.border}
                                        strokeWidth="2"
                                    />
                                    <text x={xPos} y={yScale(value) - 10} textAnchor="middle" fontSize="12" fontWeight="bold">
                                        {value.toFixed(3)}
                                    </text>

                                    {/* Significance Brackets - Restored from original */}
                                    {key.startsWith('toxin') && componentStatisticalData[activeTab]?.[key]?.pValue < 0.05 && (() => {
                                        const controlKey = `control-${subunit}`;
                                        const controlX = xPositions[controlKey];
                                        if (!controlX) return null;
                                        const significance = componentStatisticalData[activeTab]?.[key]?.significance || '';
                                        
                                        const bracketY = Math.min(yScale(value), yScale(getValue(componentMockData.control[subunit], activeTab))) - 30;

                                        return (
                                            <g>
                                                <line x1={xPos} y1={bracketY + 5} x2={xPos} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                <line x1={controlX} y1={bracketY + 5} x2={controlX} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                <line x1={xPos} y1={bracketY} x2={controlX} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                <text x={(xPos + controlX) / 2} y={bracketY - 5} textAnchor="middle" fontSize="14" fontWeight="bold">
                                                    {significance}
                                                </text>
                                            </g>
                                        );
                                    })()}

                                    {/* Error bars - Restored from original */}
                                    <line x1={xPos} y1={yScale(value - stdDev)} x2={xPos} y2={yScale(value + stdDev)} stroke="black" strokeWidth="1.5" />
                                    <line x1={xPos - 5} y1={yScale(value - stdDev)} x2={xPos + 5} y2={yScale(value - stdDev)} stroke="black" strokeWidth="1.5" />
                                    <line x1={xPos - 5} y1={yScale(value + stdDev)} x2={xPos + 5} y2={yScale(value + stdDev)} stroke="black" strokeWidth="1.5" />
                                    
                                    {/* Individual simulation data points - Restored from original */}
                                    {simPoints.map((point, idx) => (
                                        <circle
                                            key={`${key}-sim-${idx}`}
                                            cx={xPos + (idx - (simPoints.length -1)/2) * (barWidth/(simPoints.length+1))} // Adjusted spread
                                            cy={yScale(point)}
                                            r={3.5}
                                            fill={colorSet.point}
                                            opacity={0.8}
                                        />
                                    ))}
                                </g>
                            );
                        })}

                        {/* X-axis labels - Restored from original */}
                        <text x={(xPositions['toxin-AC'] + xPositions['control-AC']) / 2} y={chartHeight - margin.bottom + 35} textAnchor="middle" fontSize="13" fontWeight="bold">A:C Subunit Pair</text>
                        <text x={(xPositions['toxin-BD'] + xPositions['control-BD']) / 2} y={chartHeight - margin.bottom + 35} textAnchor="middle" fontSize="13" fontWeight="bold">B:D Subunit Pair</text>
                        
                        <text x={xPositions['toxin-AC']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Toxin</text>
                        <text x={xPositions['control-AC']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Control</text>
                        <text x={xPositions['toxin-BD']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Toxin</text>
                        <text x={xPositions['control-BD']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Control</text>

                        {/* Legend - Restored from original */}
                        {['toxin', 'control'].flatMap(condition => 
                            ['AC', 'BD'].map(subunit => {
                                const colorSet = colors[condition]?.[subunit];
                                if (!colorSet) return null;
                                const yOffset = (condition === 'toxin' ? 0 : 50) + (subunit === 'AC' ? 0 : 25);
                                return (
                                    <g key={`legend-${condition}-${subunit}`}>
                                        <rect x={chartWidth - margin.right + 20} y={margin.top + yOffset} width={15} height={15} fill={colorSet.fill} stroke={colorSet.border} />
                                        <text x={chartWidth - margin.right + 45} y={margin.top + yOffset + 8} dominantBaseline="middle" fontSize="12">
                                            {`${condition.charAt(0).toUpperCase() + condition.slice(1)} ${subunit}`}
                                        </text>
                                    </g>
                                );
                            })
                        )}
                    </svg>
                );
            };

            // Original Tab content descriptions
            const tabDescriptions = { // Restored
                mean: "The mean values show that toxin binding significantly alters G-G distances (A:C: p=0.0005, Cohen's d=2.19; B:D: p=0.0030, d=1.75). Individual data points represent different simulation runs, and error bars indicate standard deviation across simulations.",
                min: "Minimum G-G distances are significantly lower only in the B:D subunit pair (p=0.0010, d=2.05), while the A:C difference is not statistically significant (p=0.5758, d=0.27). This suggests asymmetric effects of the toxin on channel constriction.",
                max: "Maximum G-G distances are significantly higher in toxin-bound channels (A:C: p=0.0001, d=2.56; B:D: p=0.0008, d=2.61), indicating the toxin allows greater expansion of the filter in both subunit pairs.",
                range: "The range (max-min) shows the most dramatic differences, with very large effect sizes (A:C: p=0.0001, d=2.70; B:D: p<0.0001, d=3.55), providing strong evidence that the toxin causes substantial destabilization of the selectivity filter structure."
            };

            // Create statistics table data - using componentMockData
            const tableData = [ // Updated to use componentMockData
                { metric: "Mean (Å)",    "toxin-AC": `${componentMockData.toxin.AC.mean.value.toFixed(3)} ± ${componentMockData.toxin.AC.mean.stdDev.toFixed(3)}`, "toxin-BD": `${componentMockData.toxin.BD.mean.value.toFixed(3)} ± ${componentMockData.toxin.BD.mean.stdDev.toFixed(3)}`, "control-AC": `${componentMockData.control.AC.mean.value.toFixed(3)} ± ${componentMockData.control.AC.mean.stdDev.toFixed(3)}`, "control-BD": `${componentMockData.control.BD.mean.value.toFixed(3)} ± ${componentMockData.control.BD.mean.stdDev.toFixed(3)}` },
                { metric: "Min (Å)",     "toxin-AC": `${componentMockData.toxin.AC.min.value.toFixed(3)} ± ${componentMockData.toxin.AC.min.stdDev.toFixed(3)}`,   "toxin-BD": `${componentMockData.toxin.BD.min.value.toFixed(3)} ± ${componentMockData.toxin.BD.min.stdDev.toFixed(3)}`,   "control-AC": `${componentMockData.control.AC.min.value.toFixed(3)} ± ${componentMockData.control.AC.min.stdDev.toFixed(3)}`,   "control-BD": `${componentMockData.control.BD.min.value.toFixed(3)} ± ${componentMockData.control.BD.min.stdDev.toFixed(3)}` },
                { metric: "Max (Å)",     "toxin-AC": `${componentMockData.toxin.AC.max.value.toFixed(3)} ± ${componentMockData.toxin.AC.max.stdDev.toFixed(3)}`,   "toxin-BD": `${componentMockData.toxin.BD.max.value.toFixed(3)} ± ${componentMockData.toxin.BD.max.stdDev.toFixed(3)}`,   "control-AC": `${componentMockData.control.AC.max.value.toFixed(3)} ± ${componentMockData.control.AC.max.stdDev.toFixed(3)}`,   "control-BD": `${componentMockData.control.BD.max.value.toFixed(3)} ± ${componentMockData.control.BD.max.stdDev.toFixed(3)}` },
                { metric: "Range (Å)",   "toxin-AC": `${componentMockData.toxin.AC.range.value.toFixed(3)} ± ${componentMockData.toxin.AC.range.stdDev.toFixed(3)}`, "toxin-BD": `${componentMockData.toxin.BD.range.value.toFixed(3)} ± ${componentMockData.toxin.BD.range.stdDev.toFixed(3)}`, "control-AC": `${componentMockData.control.AC.range.value.toFixed(3)} ± ${componentMockData.control.AC.range.stdDev.toFixed(3)}`, "control-BD": `${componentMockData.control.BD.range.value.toFixed(3)} ± ${componentMockData.control.BD.range.stdDev.toFixed(3)}` }
            ];

            React.useEffect(() => {
                const staticTablesDiv = document.getElementById('gg-static-tables');
                if (staticTablesDiv) {
                    staticTablesDiv.style.display = 'none';
                }
            }, []);

            // Original JSX structure for the entire component - Restored
            return (
                <div className="flex flex-col items-center mt-4">
                    <h2 className="text-xl font-bold mb-4">G-G Distance Comparison: Toxin vs Control (N={numberOfSimulations} simulations)</h2>
                    <div className="flex space-x-1 mb-4">
                        {['mean', 'min', 'max', 'range'].map((tab) => (
                            <button
                                key={tab}
                                className={`px-4 py-2 rounded-t-lg font-medium ${activeTab === tab ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                                onClick={() => setActiveTab(tab)}
                            >
                                {tab === 'range' ? 'Range (Max-Min)' : tab.charAt(0).toUpperCase() + tab.slice(1)}
                            </button>
                        ))}
                    </div>
                    <div className="w-full max-w-4xl border p-4 rounded-lg bg-white">
                        {renderBarChart()}
                    </div>
                    <div className="mt-6 overflow-x-auto w-full max-w-4xl">
                        <table className="min-w-full bg-white border border-gray-300 stats-table"> {/* Added stats-table class */}
                            <thead>
                                <tr className="bg-gray-100">
                                    <th className="py-2 px-4 border-b border-r font-medium text-left">Metric</th>
                                    <th className="py-2 px-4 border-b border-r bg-blue-50 font-medium text-center">Toxin A:C</th>
                                    <th className="py-2 px-4 border-b border-r bg-red-50 font-medium text-center">Toxin B:D</th>
                                    <th className="py-2 px-4 border-b border-r bg-green-50 font-medium text-center">Control A:C</th>
                                    <th className="py-2 px-4 border-b bg-yellow-50 font-medium text-center">Control B:D</th>
                                </tr>
                            </thead>
                            <tbody>
                                {tableData.map((row, index) => (
                                    <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 even-row' : 'bg-white'}> {/* Added even-row class */}
                                        <td className="py-2 px-4 border-b border-r font-medium">{row.metric}</td>
                                        <td className="py-2 px-4 border-b border-r bg-blue-50 text-center">{row["toxin-AC"]}</td>
                                        <td className="py-2 px-4 border-b border-r bg-red-50 text-center">{row["toxin-BD"]}</td>
                                        <td className="py-2 px-4 border-b border-r bg-green-50 text-center">{row["control-AC"]}</td>
                                        <td className="py-2 px-4 border-b bg-yellow-50 text-center">{row["control-BD"]}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                    <div className="mt-4 text-sm max-w-4xl text-gray-700 p-3 bg-blue-50 rounded">
                        <p>{tabDescriptions[activeTab]}</p>
                    </div>
                    <div className="mt-4 text-sm max-w-4xl text-gray-700 p-4 bg-gray-50 rounded">
                        <h3 className="font-bold text-base mb-2">Key Observations Across Multiple Simulations:</h3>
                        <ul className="list-disc pl-6 space-y-2">
                            <li><strong>Increased Fluctuations (Range):</strong> The most striking effect is the significantly increased range of G-G distances in toxin conditions (p&lt;0.001, Cohen's d &gt; 2.7), with a very large effect size (d=3.55 for B:D). This supports the paper's central claim that Cs1 destabilizes the selectivity filter.</li>
                            <li><strong>Asymmetric Constriction:</strong> Minimum G-G distances are significantly reduced only in the B:D subunit pair (p&lt;0.01), while A:C shows no significant difference. This reveals an asymmetric effect on filter constriction, aligning with the paper's finding of asymmetric pore collapse.</li>
                            <li><strong>Enhanced Expansion:</strong> Maximum G-G distances are significantly increased in both subunit pairs (p&lt;0.001), consistent with greater filter flexibility when Cs1 disrupts the hydrogen-bond network.</li>
                            <li><strong>Mechanism Validation:</strong> These data strongly support the paper's proposed mechanism where Cs1 affects water dynamics in peripheral cavities, leading to asymmetric destabilization of the selectivity filter hydrogen-bond network, ultimately causing conduction block without direct pore occlusion.</li>
                        </ul>
                        <div className="mt-4 pt-3 border-t border-gray-300">
                            <p className="font-medium">* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001, ns = not significant</p>
                            <p>Statistical analysis: Welch's t-test for comparisons between toxin and control groups (N={numberOfSimulations} simulations each). Effect sizes reported as Cohen's d, where d &gt; 0.8 is considered large and d &gt; 1.2 very large.</p>
                        </div>
                    </div>
                </div>
            );
        };

        // G-G Fluctuation component
        const GGFluctuationComparison = () => {
            // Data from Python backend
            const summaryData = actualFluctuationSummary;
            const simulationPoints = actualFluctuationIndividual;
            const statisticalData = actualFluctuationStats;

            // Add significance symbols
            const significanceSymbols = {};
            if (statisticalData.p_values) {
                for (const subunit of ['AC', 'BD']) {
                    const pVal = statisticalData.p_values[subunit];
                    if (pVal !== null) {
                        if (pVal < 0.0001) significanceSymbols[subunit] = "****";
                        else if (pVal < 0.001) significanceSymbols[subunit] = "***";
                        else if (pVal < 0.01) significanceSymbols[subunit] = "**";
                        else if (pVal < 0.05) significanceSymbols[subunit] = "*";
                        else significanceSymbols[subunit] = "ns";
                    }
                }
            }

            // Styling constants - using your preferred design
            const chartWidth = 800;
            const chartHeight = 400;
            const margin = { top: 60, right: 150, bottom: 80, left: 80 };
            const barWidth = 60;

            // Colors - match your existing color scheme
            const colors = {
                toxin: {
                    AC: { fill: 'rgba(200, 230, 255, 0.6)', border: 'rgba(70, 130, 180, 1)', point: 'rgba(0, 102, 204, 0.8)' },
                    BD: { fill: 'rgba(255, 200, 200, 0.6)', border: 'rgba(220, 20, 60, 1)', point: 'rgba(220, 20, 60, 0.8)' }
                },
                control: {
                    AC: { fill: 'rgba(200, 255, 200, 0.6)', border: 'rgba(34, 139, 34, 1)', point: 'rgba(34, 139, 34, 0.8)' },
                    BD: { fill: 'rgba(255, 230, 180, 0.6)', border: 'rgba(255, 140, 0, 1)', point: 'rgba(255, 140, 0, 0.8)' }
                }
            };

            // X positions - match your existing layout
            const xPositions = {
                'toxin-AC': margin.left + barWidth,
                'control-AC': margin.left + barWidth * 2 + 30,
                'toxin-BD': margin.left + barWidth * 3 + 80,
                'control-BD': margin.left + barWidth * 4 + 110
            };

            // Determine Y-scale for the fluctuation values
            const getYScale = () => {
                let values = [];

                // Collect all values including error bars
                for (const condition of ['toxin', 'control']) {
                    for (const subunit of ['AC', 'BD']) {
                        if (summaryData[condition]?.[subunit]) {
                            const value = summaryData[condition][subunit].value;
                            const stdDev = summaryData[condition][subunit].stdDev;
                            if (!isNaN(value)) {
                                values.push(value);
                                // Include error bar range
                                if (!isNaN(stdDev)) {
                                    values.push(value + stdDev);
                                    values.push(value - stdDev);
                                }
                            }
                        }
                    }
                }

                // Add simulation points
                for (const condition of ['toxin', 'control']) {
                    for (const subunit of ['AC', 'BD']) {
                        if (simulationPoints[condition]?.[subunit]) {
                            values = values.concat(simulationPoints[condition][subunit]);
                        }
                    }
                }

                // Filter out null/undefined values
                values = values.filter(v => v !== null && v !== undefined && !isNaN(v));

                // Handle no data case
                if (values.length === 0) {
                    values = [0, 0.5];
                }

                // Calculate min and max with padding
                const min = Math.min(...values) * 0.9;
                const max = Math.max(...values) * 1.1;

                // Create y-scale function
                return (val) => {
                    const availableHeight = chartHeight - margin.top - margin.bottom;
                    return chartHeight - margin.bottom - ((val - min) * (availableHeight / (max - min)));
                };
            };

            // Generate tick values for y-axis
            const getTickValues = (min, max) => {
                const numTicks = 5;
                const step = (max - min) / (numTicks - 1);
                return Array.from({length: numTicks}, (_, i) => min + i * step);
            };

            // Helper functions to get values from summaryData
            const getValue = (condition, subunit) => {
                return summaryData[condition]?.[subunit]?.value || 0;
            };

            const getStdDev = (condition, subunit) => {
                return summaryData[condition]?.[subunit]?.stdDev || 0;
            };

            const getSimPoints = (condition, subunit) => {
                return simulationPoints[condition]?.[subunit] || [];
            };

            // Render the bar chart
            const renderBarChart = () => {
                // Get scale function and determine range
                const yScaleFunc = getYScale();

                // Find min and max for ticks
                let allValues = [];
                for (const condition of ['toxin', 'control']) {
                    for (const subunit of ['AC', 'BD']) {
                        const value = getValue(condition, subunit);
                        if (!isNaN(value)) {
                            allValues.push(value);
                        }
                    }
                }

                const minVal = Math.min(...allValues) * 0.9;
                const maxVal = Math.max(...allValues) * 1.1;
                const tickValues = getTickValues(minVal, maxVal);

                return (
                    <svg width={chartWidth} height={chartHeight}>
                        {/* Title */}
                        <text x={chartWidth/2} y={30} textAnchor="middle" fontSize="16" fontWeight="bold">
                            G-G Distance Fluctuation (Standard Deviation)
                        </text>

                        {/* Y-axis */}
                        <line x1={margin.left} y1={margin.top} x2={margin.left} y2={chartHeight - margin.bottom} stroke="black" strokeWidth="1.5" />
                        {tickValues.map((tick, i) => (
                            <g key={`y-tick-${i}`}>
                                <line x1={margin.left - 5} y1={yScaleFunc(tick)} x2={margin.left} y2={yScaleFunc(tick)} stroke="black" strokeWidth="1"/>
                                <text x={margin.left - 10} y={yScaleFunc(tick)} textAnchor="end" dominantBaseline="middle" fontSize="12">
                                    {tick.toFixed(2)} Å
                                </text>
                            </g>
                        ))}
                        <text transform={`rotate(-90, ${margin.left/3}, ${chartHeight/2})`} x={margin.left/3} y={chartHeight/2} textAnchor="middle" fontSize="14" fontWeight="bold">
                            Standard Deviation (Å)
                        </text>

                        {/* X-axis */}
                        <line x1={margin.left} y1={chartHeight - margin.bottom} x2={chartWidth - margin.right + 100} y2={chartHeight - margin.bottom} stroke="black" strokeWidth="1.5" />

                        {/* Bars and data points */}
                        {Object.entries(xPositions).map(([key, xPos]) => {
                            const [condition, subunit] = key.split('-');
                            const value = getValue(condition, subunit);
                            const stdDev = getStdDev(condition, subunit);
                            const simPoints = getSimPoints(condition, subunit);
                            const colorSet = colors[condition]?.[subunit];

                            if (!colorSet || isNaN(value)) return null;

                            return (
                                <g key={key}>
                                    {/* Bar */}
                                    <rect
                                        x={xPos - barWidth/2}
                                        y={yScaleFunc(value)}
                                        width={barWidth}
                                        height={Math.max(0, (chartHeight - margin.bottom) - yScaleFunc(value))}
                                        fill={colorSet.fill}
                                        stroke={colorSet.border}
                                        strokeWidth="2"
                                    />
                                    <text x={xPos} y={yScaleFunc(value) - 10} textAnchor="middle" fontSize="12" fontWeight="bold">
                                        {value.toFixed(3)}
                                    </text>

                                    {/* Error bars */}
                                    {!isNaN(stdDev) && (
                                        <>
                                            <line x1={xPos} y1={yScaleFunc(value - stdDev)} x2={xPos} y2={yScaleFunc(value + stdDev)} stroke="black" strokeWidth="1.5" />
                                            <line x1={xPos - 5} y1={yScaleFunc(value - stdDev)} x2={xPos + 5} y2={yScaleFunc(value - stdDev)} stroke="black" strokeWidth="1.5" />
                                            <line x1={xPos - 5} y1={yScaleFunc(value + stdDev)} x2={xPos + 5} y2={yScaleFunc(value + stdDev)} stroke="black" strokeWidth="1.5" />
                                        </>
                                    )}

                                    {/* Significance markers (only for toxin vs control) */}
                                    {condition === 'toxin' && significanceSymbols[subunit] && (
                                        <>
                                            {/* Draw bracket connecting toxin and control */}
                                            {(() => {
                                                const controlKey = `control-${subunit}`;
                                                const controlX = xPositions[controlKey];
                                                if (!controlX) return null;

                                                const bracketY = Math.min(
                                                    yScaleFunc(getValue(condition, subunit)),
                                                    yScaleFunc(getValue('control', subunit))
                                                ) - 30;

                                                return (
                                                    <g>
                                                        <line x1={xPos} y1={bracketY + 5} x2={xPos} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                        <line x1={controlX} y1={bracketY + 5} x2={controlX} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                        <line x1={xPos} y1={bracketY} x2={controlX} y2={bracketY} stroke="black" strokeWidth="1.5" />
                                                        <text x={(xPos + controlX) / 2} y={bracketY - 5} textAnchor="middle" fontSize="14" fontWeight="bold">
                                                            {significanceSymbols[subunit]}
                                                        </text>
                                                    </g>
                                                );
                                            })()}
                                        </>
                                    )}

                                    {/* Simulation points */}
                                    {simPoints.map((point, idx) => (
                                        <circle
                                            key={`${key}-sim-${idx}`}
                                            cx={xPos + (idx - (simPoints.length - 1)/2) * (barWidth/(simPoints.length+1))}
                                            cy={yScaleFunc(point)}
                                            r={3.5}
                                            fill={colorSet.point}
                                            opacity={0.8}
                                        />
                                    ))}
                                </g>
                            );
                        })}

                        {/* X-axis labels */}
                        <text x={(xPositions['toxin-AC'] + xPositions['control-AC']) / 2} y={chartHeight - margin.bottom + 35} textAnchor="middle" fontSize="13" fontWeight="bold">A:C Subunit Pair</text>
                        <text x={(xPositions['toxin-BD'] + xPositions['control-BD']) / 2} y={chartHeight - margin.bottom + 35} textAnchor="middle" fontSize="13" fontWeight="bold">B:D Subunit Pair</text>

                        <text x={xPositions['toxin-AC']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Toxin</text>
                        <text x={xPositions['control-AC']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Control</text>
                        <text x={xPositions['toxin-BD']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Toxin</text>
                        <text x={xPositions['control-BD']} y={chartHeight - margin.bottom + 20} textAnchor="middle" fontSize="12">Control</text>

                        {/* Legend */}
                        {['toxin', 'control'].flatMap(condition =>
                            ['AC', 'BD'].map(subunit => {
                                const colorSet = colors[condition]?.[subunit];
                                if (!colorSet) return null;
                                const yOffset = (condition === 'toxin' ? 0 : 50) + (subunit === 'AC' ? 0 : 25);
                                return (
                                    <g key={`legend-${condition}-${subunit}`}>
                                        <rect x={chartWidth - margin.right + 20} y={margin.top + yOffset} width={15} height={15} fill={colorSet.fill} stroke={colorSet.border} />
                                        <text x={chartWidth - margin.right + 45} y={margin.top + yOffset + 8} dominantBaseline="middle" fontSize="12">
                                            {`${condition.charAt(0).toUpperCase() + condition.slice(1)} ${subunit}`}
                                        </text>
                                    </g>
                                );
                            })
                        )}
                    </svg>
                );
            };

            // Create table data for displaying values
            const tableData = {
                "toxin-AC": `${summaryData.toxin?.AC?.value?.toFixed(3) || "N/A"} ± ${summaryData.toxin?.AC?.stdDev?.toFixed(3) || "N/A"}`,
                "toxin-BD": `${summaryData.toxin?.BD?.value?.toFixed(3) || "N/A"} ± ${summaryData.toxin?.BD?.stdDev?.toFixed(3) || "N/A"}`,
                "control-AC": `${summaryData.control?.AC?.value?.toFixed(3) || "N/A"} ± ${summaryData.control?.AC?.stdDev?.toFixed(3) || "N/A"}`,
                "control-BD": `${summaryData.control?.BD?.value?.toFixed(3) || "N/A"} ± ${summaryData.control?.BD?.stdDev?.toFixed(3) || "N/A"}`
            };

            // Create statistical data for display
            const statsData = {
                "ac-pvalue": statisticalData.p_values?.AC !== null ?
                    statisticalData.p_values.AC.toFixed(4) : "N/A",
                "bd-pvalue": statisticalData.p_values?.BD !== null ?
                    statisticalData.p_values.BD.toFixed(4) : "N/A",
                "ac-effect": statisticalData.effect_sizes?.AC !== null ?
                    statisticalData.effect_sizes.AC.toFixed(2) : "N/A",
                "bd-effect": statisticalData.effect_sizes?.BD !== null ?
                    statisticalData.effect_sizes.BD.toFixed(2) : "N/A"
            };

            // Hide static table when component loads
            React.useEffect(() => {
                const staticTable = document.getElementById('gg-fluctuation-static-table');
                if (staticTable) {
                    staticTable.style.display = 'none';
                }
            }, []);

            return (
                <div className="flex flex-col items-center mt-4">
                    <h2 className="text-xl font-bold mb-4">G-G Distance Fluctuation: Toxin vs Control (N={numberOfSimulations} simulations)</h2>

                    {/* Bar chart */}
                    <div className="w-full max-w-4xl border p-4 rounded-lg bg-white">
                        {renderBarChart()}
                    </div>

                    {/* Data table */}
                    <div className="mt-6 overflow-x-auto w-full max-w-4xl">
                        <table className="min-w-full bg-white border border-gray-300 stats-table">
                            <thead>
                                <tr className="bg-gray-100">
                                    <th className="py-2 px-4 border-b border-r font-medium text-left">Metric</th>
                                    <th className="py-2 px-4 border-b border-r bg-blue-50 font-medium text-center">Toxin A:C</th>
                                    <th className="py-2 px-4 border-b border-r bg-red-50 font-medium text-center">Toxin B:D</th>
                                    <th className="py-2 px-4 border-b border-r bg-green-50 font-medium text-center">Control A:C</th>
                                    <th className="py-2 px-4 border-b bg-yellow-50 font-medium text-center">Control B:D</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td className="py-2 px-4 border-b border-r font-medium">G-G Fluctuation (Å)</td>
                                    <td className="py-2 px-4 border-b border-r bg-blue-50 text-center">{tableData["toxin-AC"]}</td>
                                    <td className="py-2 px-4 border-b border-r bg-red-50 text-center">{tableData["toxin-BD"]}</td>
                                    <td className="py-2 px-4 border-b border-r bg-green-50 text-center">{tableData["control-AC"]}</td>
                                    <td className="py-2 px-4 border-b bg-yellow-50 text-center">{tableData["control-BD"]}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    {/* Statistical table */}
                    <div className="mt-6 overflow-x-auto w-full max-w-4xl">
                        <table className="min-w-full bg-white border border-gray-300 stats-table">
                            <thead>
                                <tr className="bg-gray-100">
                                    <th className="py-2 px-4 border-b border-r font-medium text-left">Subunit Pair</th>
                                    <th className="py-2 px-4 border-b border-r font-medium text-center">p-value</th>
                                    <th className="py-2 px-4 border-b font-medium text-center">Effect Size (Cohen's d)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td className="py-2 px-4 border-b border-r font-medium">A:C Subunit</td>
                                    <td className="py-2 px-4 border-b border-r text-center">{statsData["ac-pvalue"]}</td>
                                    <td className="py-2 px-4 border-b text-center">{statsData["ac-effect"]}</td>
                                </tr>
                                <tr className="bg-gray-50">
                                    <td className="py-2 px-4 border-b border-r font-medium">B:D Subunit</td>
                                    <td className="py-2 px-4 border-b border-r text-center">{statsData["bd-pvalue"]}</td>
                                    <td className="py-2 px-4 border-b text-center">{statsData["bd-effect"]}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    {/* Interpretation */}
                    <div className="mt-4 text-sm max-w-4xl text-gray-700 p-3 bg-blue-50 rounded">
                        <p>The G-G distance fluctuation is measured as the standard deviation of the time series data for each simulation.
                        Higher values indicate greater variability in glycine-glycine distances across the selectivity filter.
                        This metric directly quantifies the conformational flexibility of the filter during the simulation.</p>
                    </div>

                    {/* Key observations */}
                    <div className="mt-4 text-sm max-w-4xl text-gray-700 p-4 bg-gray-50 rounded">
                        <h3 className="font-bold text-base mb-2">Key Observations:</h3>
                        <ul className="list-disc pl-6 space-y-2">
                            <li><strong>Enhanced Fluctuations:</strong> Toxin-bound channels show significantly increased standard deviations in G-G distances, directly demonstrating greater conformational instability of the selectivity filter.</li>
                            <li><strong>Mechanism Insight:</strong> These increased fluctuations provide direct evidence that the toxin's mechanism involves destabilizing the filter structure rather than directly blocking it.</li>
                            <li><strong>Structure-Function Relationship:</strong> The increased fluctuations correlate with decreased ion conductance, supporting the hypothesis that filter stability is essential for optimal ion permeation.</li>
                        </ul>
                        <div className="mt-4 pt-3 border-t border-gray-300">
                            <p className="font-medium">* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001, ns = not significant</p>
                            <p>Statistical analysis: Welch's t-test for comparisons between toxin and control groups (N={numberOfSimulations} simulations each). Effect sizes reported as Cohen's d, where d &gt; 0.8 is considered large and d &gt; 1.2 very large.</p>
                        </div>
                    </div>
                </div>
            );
        };

        // Render Pore Geometry component
        ReactDOM.render(
            <GGDistanceTabbedComparison />,
            document.getElementById('gg-distance-react-root')
        );

        // Render Fluctuation component if present on page
        const fluctuationRoot = document.getElementById('gg-fluctuation-react-root');
        if (fluctuationRoot) {
            ReactDOM.render(
                <GGFluctuationComparison />,
                fluctuationRoot
            );
        }
    </script>
</body>
</html>